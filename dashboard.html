<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arch Angels Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="bot-icon">
                <img src="https://i.postimg.cc/Pr31Rx40/Here-is-a-non-realistic-profile-picture-in-a-gold-white-and-blue-theme-inspired-by-an-Archangel.png" alt="Bot Icon">
            </div>
            <ul class="menu">
                <li><button class="menu-btn" onclick="showPage('dashboard')">Dashboard</button></li>
                <li><button class="menu-btn" onclick="window.location.href='https://blake0v2.github.io/ArchAngelCommands/commands.html'">Commands</button></li>
                <li><button class="menu-btn" onclick="window.location.href='https://blake0v2.github.io/CurrentRaid/currentraid.html'">Current Raid</button></li>
                <li><button class="menu-btn" onclick="showPage('leaderboard')">Leaderboard</button></li>
                <li><button class="menu-btn" onclick="showPage('desert-carry')">Desert Carry</button></li>
            </ul>
            <!-- Log Out Button -->
            <a href="#" onclick="logout()" class="logout-btn">Log Out [‚ûî</a>
        </div>
        <div class="content">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page">
            <div class="dashboard-box">
                <div id="user-avatar">
                    <!-- This will dynamically set the avatar image based on the authenticated user -->
                    <img id="avatar" src="" alt="User Avatar">
                </div>
                <h1>Welcome, <span id="username">{{ username }}</span>!</h1> <!-- The user's actual username will be dynamically set here -->
                <footer>
                    <p>This is the Arch Angels official website, developed by @Blake0_o</p>
                    <p>Please show your support by joining our Discord: <a href="https://discord.gg/TheArchAngels" target="_blank">Discord.gg/TheArchAngels</a></p>
                </footer>
            </div>
        </div>

        <div id="leaderboard" class="page" style="display:none;">
            <h2>üèÜLeaderboard</h2>
            <div class="leaderboard-category">
                <h3>Economy Commands</h3>
                <div class="command-list">
                    <div class="command-item">
                        <button class="command-btn" title="Check your account balance">/balance</button>
                        <div class="command-description">Check your account balance in the economy system.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
        <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arch Angels Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="bot-icon">
                <img src="https://i.postimg.cc/Pr31Rx40/Here-is-a-non-realistic-profile-picture-in-a-gold-white-and-blue-theme-inspired-by-an-Archangel.png" alt="Bot Icon">
            </div>
            <ul class="menu">
                <li><button class="menu-btn" onclick="showPage('dashboard')">Dashboard</button></li>
                <li><button class="menu-btn" onclick="window.location.href='https://blake0v2.github.io/ArchAngelCommands/commands.html'">Commands</button></li>
                <li><button class="menu-btn" onclick="window.location.href='https://blake0v2.github.io/CurrentRaid/currentraid.html'">Current Raid</button></li>
                <li><button class="menu-btn" onclick="showPage('leaderboard')">Leaderboard</button></li>
                <li><button class="menu-btn" onclick="showPage('desert-carry')">Desert Carry</button></li>
            </ul>
            <!-- Log Out Button -->
            <a href="#" onclick="logout()" class="logout-btn">Log Out [‚ûî</a>
        </div>
        <div class="content">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page">
            <div class="dashboard-box">
                <div id="user-avatar">
                    <!-- This will dynamically set the avatar image based on the authenticated user -->
                    <img id="avatar" src="" alt="User Avatar">
                </div>
                <h1>Welcome, <span id="username">{{ username }}</span>!</h1> <!-- The user's actual username will be dynamically set here -->
                <footer>
                    <p>This is the Arch Angels official website, developed by @Blake0_o</p>
                    <p>Please show your support by joining our Discord: <a href="https://discord.gg/TheArchAngels" target="_blank">Discord.gg/TheArchAngels</a></p>
                </footer>
            </div>
        </div>

        <div id="leaderboard" class="page" style="display:none;">
            <h2>üèÜLeaderboard</h2>
            <div class="leaderboard-category">
                <h3>Economy Commands</h3>
                <div class="command-list">
                    <div class="command-item">
                        <button class="command-btn" title="Check your account balance">/balance</button>
                        <div class="command-description">Check your account balance in the economy system.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Function to fetch Discord user data after OAuth2 login
        const clientId = '1404595445275164804'; // Replace with your Discord app client ID
        const redirectUri = 'https://blake0v2.github.io/CelestialBeingDashboard/dashboard.html'; // Your redirect URL
        const oauthUrl = `https://discord.com/oauth2/authorize?client_id=${clientId}&redirect_uri=${redirectUri}&response_type=token&scope=identify`;
        
        // Check if the URL contains the access token (redirect after OAuth2)
        if (window.location.hash) {
            const urlParams = new URLSearchParams(window.location.hash.substring(1));
            const token = urlParams.get('access_token');
            
            if (token) {
                // Save the token in localStorage
                localStorage.setItem('discord_token', token);
                // Redirect to the same page to avoid token being in the URL
                window.location.hash = '';
                window.location.reload();
            }
        }
        
        // Check if the user is authenticated
        if (!localStorage.getItem('discord_token')) {
            // Redirect to OAuth2 login if not authenticated
            window.location.href = oauthUrl;
        } else {
            // Fetch user data using the Discord API
            const token = localStorage.getItem('discord_token');
            fetch('https://discord.com/api/v10/users/@me', {
                headers: {
                    Authorization: `Bearer ${token}`
                }
            })
            .then(response => response.json())
            .then(data => {
                // Set the username and avatar dynamically
                document.getElementById('username').innerText = data.username;
                document.getElementById('avatar').src = data.avatar ? `https://cdn.discordapp.com/avatars/${data.id}/${data.avatar}.png` : 'default-avatar.png';
            })
            .catch(err => {
                console.error('Error fetching user data: ', err);
            });
        }
        
        // Log out function
        function logout() {
            localStorage.removeItem('discord_token');
            window.location.reload();
        }
        
        // Function to show a specific page and hide others
        function showPage(pageId) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.style.display = 'none');
            const selectedPage = document.getElementById(pageId);
            selectedPage.style.display = 'block';
        }
    </script>
</body>
</html>
